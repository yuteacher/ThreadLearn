3.6.3 工作原理
线程池还有一个有用的方法:ThreadPool.RegisterWaitForSingleObject。该方法允许我们将回调函数放人线程池中的队列中。当提供的等待事件处理器收到信号或发生超时时，该回调函数将被调用。这允许我们为线程池中的操作实现超时功能。
首先按顺序向线程池中放入一个耗时长的操作。它运行6秒钟然后一旦成功完成会设置一个ManualResetEvent信号类。其他的情况下，比如需要取消操作，则该操作会被丢弃。
然后我们注册了第二个异步操作。当从ManualResetEvent对象接受到一个信号后，该异步操作会被调用。如果第一个操作顺利完成，会设置该信号量。另一种情况是第一个操作还未完成就已经超时。如果发生了该情况，我们会使用CancellationToken来取消第一个操作。
最后，为操作提供5秒的超时时间是不够的。这是因为操作会花费6秒来完成，只能取消该操作。所以如果提供7秒的超时时间是可行的，该操作会顺利完成。